---
title: "07. G-score"
output:
  html_document:
    theme: cosmo
    highlight: zenburn
    css: "../css/note-style.css"
---

```{r, message=FALSE, echo=FALSE}
source("../funs/funs.R")
options(dsst.traceit = FALSE)
```

# Load the Data

As in the previous notes, I will use the Amazon product classification task.
We will read in the `docs` and `anno` tables:

```{r, message = FALSE}
docs <- read_csv("../data/amazon_product_class.csv")
anno <- read_csv("../data/amazon_product_class_token.csv.gz")
```

Today, we are going to derive a new metric for seeing how strongly a term is
associated with a category.

## G-Score

Here is a function that computes the G-scores for a set of terms related to
each label in the data.

```{r}
dsst_metrics(anno, docs)
```

By default the table is ordered by category and then in ascending order by the
gscore. You'll probably want to select only the top scores for each label, which
can be done as follows:

```{r}
dsst_metrics(anno, docs) %>%
  group_by(label) %>%
  slice_head(n = 4)
```

And as with previous notes, we can modify and filter the initial dataset before
running the metrics:

```{r}
anno %>%
  mutate(lemma = if_else(upos == "PRON", tolower(token), lemma)) %>%
  mutate(lemma = if_else(lemma == "i", "I", lemma)) %>%
  filter(upos %in% c("ADJ", "ADV", "NOUN", "VERB", "PRON")) %>%
  dsst_metrics(docs) %>%
  group_by(label) %>%
  slice_head(n = 4)
```

The last column is a measurement that we will talk about in the next set of 
notes.
